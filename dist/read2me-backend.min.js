"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Read2MeBackendWrapper=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"custom";_classCallCheck(this,e),this.apiUrl="https://api-dev.read2me.online/convert/1.0.0/webpage/",this.appId=t,this.url=n,this.cssSelectors=o,this.voice=r,this.ignoreContentChange=s,this.requestSource=a,this._validateRequiredParams(),this._validateOptionalParams(),this._normaliseParams()}return _createClass(e,[{key:"_validateRequiredParams",value:function(){if(void 0===this.appId)throw"First param to Read2MePlayer must be an App Id.";if("number"!=typeof this.appId)throw"Public API key must be a number.";if("string"!=typeof this.url)throw"Second param to Read2MePlayer (url) must be a string.";if(0===this.url.length)throw"url must not be empty"}},{key:"_validateOptionalParams",value:function(){if(null!==this.cssSelectors&&"object"!==_typeof(this.cssSelectors))throw"Third param to Read2MePlayer (cssSelectors) must be null or array.";if(null!==this.voice&&"string"!=typeof this.voice)throw"Fourth param to Read2MePlayer(voice) must be null or string";if("boolean"!=typeof this.ignoreContentChange)throw"Fifth param to Read2MePlayer (ignoreContentChange) must be a boolean.";if("string"!=typeof this.requestSource)throw"Sixth param to Read2MeBackend (requestSource) must be a string"}},{key:"_normaliseParams",value:function(){void 0!==this.cssSelectors&&null!==this.cssSelectors||(this.cssSelectors=[])}},{key:"_getIgnoreContentChangeAsString",value:function(){return this.ignoreContentChange?"true":"false"}},{key:"getRequestUri",value:function(){var e=null!==this.voice?encodeURIComponent(this.voice):"";return this.apiUrl+"?url="+encodeURIComponent(this.url)+"&css_selectors="+encodeURIComponent(this.cssSelectors.join("|"))+"&voice="+e+"&ignore_content_change="+this._getIgnoreContentChangeAsString()+"&request_source="+this.requestSource}},{key:"get",value:function(e,t,n){var o=new XMLHttpRequest;o.open("GET",this.getRequestUri(),!0),o.setRequestHeader("X-App-Id",this.appId),o.onload=function(){var r=JSON.parse(o.responseText);o.status>=200&&o.status<400?e(r):404===o.status?t(r):n(r)},o.onerror=function(){n(),console.warn("Connection to Read2Me backend API failed.")},o.send()}},{key:"create",value:function(e,t){var n=new XMLHttpRequest;n.open("POST",this.getRequestUri(),!0),n.setRequestHeader("X-App-Id",this.appId),n.onload=function(){var o=JSON.parse(n.responseText);n.status>=200&&n.status<400?e(o):t(o)},n.onerror=function(){t(),console.warn("Connection to Read2Me API failed.")},n.send()}}]),e}();exports.default=Read2MeBackendWrapper;